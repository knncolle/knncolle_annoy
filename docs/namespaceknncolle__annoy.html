<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>knncolle_annoy: knncolle_annoy Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">knncolle_annoy
   </div>
   <div id="projectbrief">Annoy nearest neighbors in knncolle</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">knncolle_annoy Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Approximate nearest neighbor search with Annoy.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classknncolle__annoy_1_1AnnoyBuilder.html">AnnoyBuilder</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform an approximate nearest neighbor search with Annoy.  <a href="classknncolle__annoy_1_1AnnoyBuilder.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structknncolle__annoy_1_1AnnoyOptions.html">AnnoyOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code>AnnoyBuilder()</code>.  <a href="structknncolle__annoy_1_1AnnoyOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structknncolle__annoy_1_1AnnoyPrebuiltTypes.html">AnnoyPrebuiltTypes</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Template types of a saved Annoy index.  <a href="structknncolle__annoy_1_1AnnoyPrebuiltTypes.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a57a33c712b732200c7b46d36f13bfb78" id="r_a57a33c712b732200c7b46d36f13bfb78"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structknncolle__annoy_1_1AnnoyPrebuiltTypes.html">AnnoyPrebuiltTypes</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57a33c712b732200c7b46d36f13bfb78">load_annoy_prebuilt_types</a> (const std::string &amp;prefix)</td></tr>
<tr class="separator:a57a33c712b732200c7b46d36f13bfb78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a480d8350b6c83729f140253ee3ca64cb" id="r_a480d8350b6c83729f140253ee3ca64cb"><td class="memTemplParams" colspan="2">template&lt;typename Index_ , typename Data_ , typename Distance_ , class AnnoyDistance_ , typename AnnoyIndex_  = Index_, typename AnnoyData_  = float, class AnnoyRng_  = Annoy::Kiss64Random, class AnnoyThreadPolicy_  = Annoy::AnnoyIndexSingleThreadedBuildPolicy&gt; </td></tr>
<tr class="memitem:a480d8350b6c83729f140253ee3ca64cb"><td class="memTemplItemLeft" align="right" valign="top">auto&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a480d8350b6c83729f140253ee3ca64cb">load_annoy_prebuilt</a> (const std::string &amp;prefix)</td></tr>
<tr class="separator:a480d8350b6c83729f140253ee3ca64cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f46fd7ab22d7976baec00c98c038bea" id="r_a0f46fd7ab22d7976baec00c98c038bea"><td class="memTemplParams" colspan="2">template&lt;typename AnnoyDistance_ &gt; </td></tr>
<tr class="memitem:a0f46fd7ab22d7976baec00c98c038bea"><td class="memTemplItemLeft" align="right" valign="top">const char *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a0f46fd7ab22d7976baec00c98c038bea">get_distance_name</a> ()</td></tr>
<tr class="separator:a0f46fd7ab22d7976baec00c98c038bea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46b2125811a26fae459c4c54803be3ae" id="r_a46b2125811a26fae459c4c54803be3ae"><td class="memTemplParams" colspan="2">template&lt;class AnnoyDistance_ , typename AnnoyIndex_ , typename AnnoyData_ &gt; </td></tr>
<tr class="memitem:a46b2125811a26fae459c4c54803be3ae"><td class="memTemplItemLeft" align="right" valign="top">std::function&lt; void(const std::string &amp;)&gt; &amp;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a46b2125811a26fae459c4c54803be3ae">customize_save_for_annoy_types</a> ()</td></tr>
<tr class="separator:a46b2125811a26fae459c4c54803be3ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Approximate nearest neighbor search with Annoy. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a46b2125811a26fae459c4c54803be3ae" name="a46b2125811a26fae459c4c54803be3ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46b2125811a26fae459c4c54803be3ae">&#9670;&#160;</a></span>customize_save_for_annoy_types()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class AnnoyDistance_ , typename AnnoyIndex_ , typename AnnoyData_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::function&lt; void(const std::string &amp;)&gt; &amp; knncolle_annoy::customize_save_for_annoy_types </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Define a customized saving function to preserve type information from the Annoy index in <code><a class="elRef" href="https://knncolle.github.io/knncolle/classknncolle_1_1Prebuilt.html#a87930f878bf3a22297b851173caaf893">knncolle::Prebuilt::save()</a></code>. Users can provide their own function here, to handle types that are unknown to <code><a class="elRef" href="https://knncolle.github.io/knncolle/namespaceknncolle.html#a84e640363d9246c58008c93166021f26">knncolle::get_numeric_type()</a></code> or <code><a class="el" href="#a0f46fd7ab22d7976baec00c98c038bea">get_distance_name()</a></code>. Any modifications to this function are not thread-safe and should be done in a serial section.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">AnnoyDistance_</td><td>An <b>Annoy</b>-compatible class to compute the distance between vectors. </td></tr>
    <tr><td class="paramname">AnnoyIndex_</td><td>Integer type for the observation indices in the Annoy index. </td></tr>
    <tr><td class="paramname">AnnoyData_</td><td>Floating-point type for data in the Annoy index.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A global function for saving information about <code>AnnoyDistance_</code>, <code>AnnoyIndex_</code> and <code>AnnoyData_</code>. If set, this will be called by the <code><a class="elRef" href="https://knncolle.github.io/knncolle/classknncolle_1_1Prebuilt.html#a87930f878bf3a22297b851173caaf893">knncolle::Prebuilt::save()</a></code> method for the Annoy <code>Prebuilt</code> subclass. </dd></dl>

</div>
</div>
<a id="a0f46fd7ab22d7976baec00c98c038bea" name="a0f46fd7ab22d7976baec00c98c038bea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f46fd7ab22d7976baec00c98c038bea">&#9670;&#160;</a></span>get_distance_name()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename AnnoyDistance_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const char * knncolle_annoy::get_distance_name </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">AnnoyDistance_</td><td>An <b>Annoy</b>-compatible class to compute the distance between vectors, as used in <code>AnnoyBuilder()</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Name of the distance metric, e.g., <code>"euclidean"</code>, <code>"manhattan"</code>. This is taken from <code>AnnoyDistance_::name()</code> if such a method exists, otherwise <code>"unknown"</code> is returned.</dd></dl>
<p>For unknown distances, consider using <code><a class="el" href="#a46b2125811a26fae459c4c54803be3ae">customize_save_for_annoy_types()</a></code> to add more information to the on-disk representation during a <code><a class="elRef" href="https://knncolle.github.io/knncolle/classknncolle_1_1Prebuilt.html#a87930f878bf3a22297b851173caaf893">knncolle::Prebuilt::save()</a></code> call. </p>

</div>
</div>
<a id="a480d8350b6c83729f140253ee3ca64cb" name="a480d8350b6c83729f140253ee3ca64cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a480d8350b6c83729f140253ee3ca64cb">&#9670;&#160;</a></span>load_annoy_prebuilt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Index_ , typename Data_ , typename Distance_ , class AnnoyDistance_ , typename AnnoyIndex_  = Index_, typename AnnoyData_  = float, class AnnoyRng_  = Annoy::Kiss64Random, class AnnoyThreadPolicy_  = Annoy::AnnoyIndexSingleThreadedBuildPolicy&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">auto knncolle_annoy::load_annoy_prebuilt </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>prefix</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Helper function to define a <code><a class="elRef" href="https://knncolle.github.io/knncolle/namespaceknncolle.html#af5bf682899b815f8e1d4a4c6ef80408a">knncolle::LoadPrebuiltFunction</a></code> for Annoy in <code>knncolle::load_prebuilt()</code>.</p>
<p>To load an Annoy index from disk, users are expected to define and register an Annoy-specific <code><a class="elRef" href="https://knncolle.github.io/knncolle/namespaceknncolle.html#af5bf682899b815f8e1d4a4c6ef80408a">knncolle::LoadPrebuiltFunction</a></code>. In this function, users should first call <code><a class="el" href="#a57a33c712b732200c7b46d36f13bfb78">load_annoy_prebuilt_types()</a></code> to figure out the saved index's <code>AnnoyDistance_</code>, <code>AnnoyIndex</code> and <code>AnnoyData_</code>. Then, they should call <code><a class="el" href="#a480d8350b6c83729f140253ee3ca64cb">load_annoy_prebuilt()</a></code> with the appropriate types to return a pointer to a <code><a class="elRef" href="https://knncolle.github.io/knncolle/classknncolle_1_1Prebuilt.html">knncolle::Prebuilt</a></code> object. This user-defined function should be registered in <code>load_prebuilt_registry()</code> with the key in <code>knncolle_annoy::save_name</code>.</p>
<p>We do not define a default function for loading Annoy indices as there are too many possible combinations of types. Instead, the user is responsible for deciding which combinations of types should be handled. This avoids binary bloat from repeated instantiations of the Annoy template classes, if an application only deals with a certain subset of combinations. For types or distances that are unknown to <code><a class="elRef" href="https://knncolle.github.io/knncolle/namespaceknncolle.html#a84e640363d9246c58008c93166021f26">knncolle::get_numeric_type()</a></code> or <code><a class="el" href="#a0f46fd7ab22d7976baec00c98c038bea">get_distance_name()</a></code>, respectively, users can store additional information on disk via <code><a class="el" href="#a46b2125811a26fae459c4c54803be3ae">customize_save_for_annoy_types()</a></code> for use in loading.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for the observation indices. </td></tr>
    <tr><td class="paramname">Data_</td><td>Numeric type for the input and query data. </td></tr>
    <tr><td class="paramname">Distance_</td><td>Floating-point type for the distances. </td></tr>
    <tr><td class="paramname">AnnoyDistance_</td><td>An <b>Annoy</b>-compatible class to compute the distance between vectors. This should be the same as the distance reported in <code>PrebuiltSaveConfig::distance</code>. </td></tr>
    <tr><td class="paramname">AnnoyIndex_</td><td>Integer type for the observation indices in the Annoy index. This should be the same as the type reported by <code>PrebuiltSaveConfig::index</code>. </td></tr>
    <tr><td class="paramname">AnnoyData_</td><td>Floating-point type for data in the Annoy index. This should be the same as the type reported by <code>PrebuiltSaveConfig::data</code>. </td></tr>
    <tr><td class="paramname">AnnoyRng_</td><td>An <b>Annoy</b> class for random number generation. This is provided for completeness and has no effect as the index is already built. </td></tr>
    <tr><td class="paramname">AnnoyThreadPolicy_</td><td>An <b>Annoy</b> class for the threadedness of Annoy index building. This is provided for completeness and has no effect as the index is already built.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prefix</td><td>Prefix of the file paths in which a prebuilt Annoy index was saved. An Annoy index is typically saved by calling the <code><a class="elRef" href="https://knncolle.github.io/knncolle/classknncolle_1_1Prebuilt.html#a87930f878bf3a22297b851173caaf893">knncolle::Prebuilt::save()</a></code> method of the Annoy subclass instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to a <code><a class="elRef" href="https://knncolle.github.io/knncolle/classknncolle_1_1Prebuilt.html">knncolle::Prebuilt</a></code> Annoy index. </dd></dl>

</div>
</div>
<a id="a57a33c712b732200c7b46d36f13bfb78" name="a57a33c712b732200c7b46d36f13bfb78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57a33c712b732200c7b46d36f13bfb78">&#9670;&#160;</a></span>load_annoy_prebuilt_types()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structknncolle__annoy_1_1AnnoyPrebuiltTypes.html">AnnoyPrebuiltTypes</a> knncolle_annoy::load_annoy_prebuilt_types </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>prefix</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prefix</td><td>Prefix of the file paths in which a prebuilt Annoy index was saved. An Annoy index is typically saved by calling the <code><a class="elRef" href="https://knncolle.github.io/knncolle/classknncolle_1_1Prebuilt.html#a87930f878bf3a22297b851173caaf893">knncolle::Prebuilt::save()</a></code> method of the Annoy subclass instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Template types of the saved instance of a <code><a class="elRef" href="https://knncolle.github.io/knncolle/classknncolle_1_1Prebuilt.html">knncolle::Prebuilt</a></code> Annoy subclass. This is typically used to choose template parameters for <code><a class="el" href="#a480d8350b6c83729f140253ee3ca64cb">load_annoy_prebuilt()</a></code>. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
